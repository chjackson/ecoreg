Better error checking 

Comprehensive test scripts 
